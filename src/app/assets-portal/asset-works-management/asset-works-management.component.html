<div class="row" *ngIf="worksManagementData?.length > 0">
  
      <div class="col-md-2">
          <div class="dropdown" id="nesting-dropdown-demo">
              <button type="button" class="btn btn-sm dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Export</button>
              <div class="dropdown-menu" x-placement="bottom-start" style="position: absolute; will-change: top, left; top: 38px; left: 0px;">
    
                  <a class="dropdown-item" (click)="exportToExcel(grid,'xlsx')" href="javascript:void(0)">Export Grid</a>
                  <a class="dropdown-item" (click)="exportToExcel(grid,'xlsx','selected')" href="javascript:void(0)">Export
                      Selected</a>
                <!-- <div class="dropdown-toggle">
                  <div class="dropdown-item">Export Grid</div>
                  <div class="dropdown-menu">
                      <a class="dropdown-item" (click)="exportToExcel(grid,'xlsx')" href="javascript:void(0)">Export Excel</a>
                      <a class="dropdown-item" (click)="exportToExcel(grid,'csv')" href="javascript:void(0)">Export Csv</a>
                      <a class="dropdown-item" (click)="exportToExcel(grid,'txt')" href="javascript:void(0)">Export Text</a>
                      <a class="dropdown-item" (click)="exportToExcel(grid,'html')" href="javascript:void(0)">Export Html</a>
                  </div>
                </div>
               
               
                <div class="dropdown-toggle">
                  <div class="dropdown-item">Export Selected</div>
                  <div class="dropdown-menu">
                      <a class="dropdown-item" (click)="exportToExcel(grid,'xlsx','selected')" href="javascript:void(0)">Export Excel</a>
                      <a class="dropdown-item" (click)="exportToExcel(grid,'csv','selected')" href="javascript:void(0)">Export Csv</a>
                      <a class="dropdown-item" (click)="exportToExcel(grid,'txt','selected')" href="javascript:void(0)">Export Text</a>
                      <a class="dropdown-item" (click)="exportToExcel(grid,'html','selected')" href="javascript:void(0)">Export Html</a>
                  </div>
                </div> -->
              </div>
            </div>
        </div>
  </div>

<div class="row mt-2">
    <div class="col-md-12">
      <kendo-grid 
      #grid="kendoGrid"
      [data]="gridView"
      [skip]="state.skip" 
      [sort]="state.sort" 
      [filter]="state.filter"
      filterable="menu" 
      [resizable]="true"
      [groupable]="true" 
      (groupChange)="groupChange($event)"
      [group]="state.group"
      [sortable]="{
            allowUnsort: allowUnsort,
            mode: multiple ? 'multiple' : 'single'
            }" 
      (sortChange)="sortChange($event)" 
      (filterChange)="filterChange($event)" 
      [selectable]="{
        mode: 'multiple'
      }" 
      [kendoGridSelectBy]="mySelectionKey"
      (cellClick)="cellClickHandler($event)"
      [selectedKeys]="mySelection"
      (selectionChange)="selectedRowChange($event)"
      (click)="openWorkDetail($event)"
      [height]="610"
      >
        
        <kendo-grid-column field="element" title="Element" width="140">
            <ng-template kendoGridCellTemplate let-dataItem>
                <span [style.color]="dataItem.status == 'CANCELLED' ? 'red' : dataItem.status == 'TRANSFERRED' ? 'green' : dataItem.status == 'NEW' ? 'blue' : 'black'" >
                  {{ dataItem.element }}
                </span>
              </ng-template>
         
        </kendo-grid-column>
        <kendo-grid-column field="attribute" title="Attribute" width="250">
            <ng-template kendoGridCellTemplate let-dataItem>
                <span [style.color]="dataItem.status == 'CANCELLED' ? 'red' : dataItem.status == 'TRANSFERRED' ? 'green' : dataItem.status == 'NEW' ? 'blue' : 'black'" >
                  {{ dataItem.attribute }}
                </span>
              </ng-template>
        </kendo-grid-column>
        <kendo-grid-column field="plan_Year" title="Plan Year" width="110" filter="numeric">
            <ng-template kendoGridCellTemplate let-dataItem>
                <span [style.color]="dataItem.status == 'CANCELLED' ? 'red' : dataItem.status == 'TRANSFERRED' ? 'green' : dataItem.status == 'NEW' ? 'blue' : 'black'" >
                  {{ dataItem.plan_Year }}
                </span>
              </ng-template>
        </kendo-grid-column>
        <kendo-grid-column field="contractor" title="Contractor" width="130">
            <ng-template kendoGridCellTemplate let-dataItem>
                <span [style.color]="dataItem.status == 'CANCELLED' ? 'red' : dataItem.status == 'TRANSFERRED' ? 'green' : dataItem.status == 'NEW' ? 'blue' : 'black'" >
                  {{ dataItem.contractor }}
                </span>
              </ng-template>
        </kendo-grid-column>
        <kendo-grid-column field="cttname" title="Contract" width="150">
            <ng-template kendoGridCellTemplate let-dataItem>
                <span [style.color]="dataItem.status == 'CANCELLED' ? 'red' : dataItem.status == 'TRANSFERRED' ? 'green' : dataItem.status == 'NEW' ? 'blue' : 'black'" >
                  {{ dataItem.cttname }}
                </span>
              </ng-template>
        </kendo-grid-column>
        
        <kendo-grid-column field="work_Package" title="Work Package" width="160">
            <ng-template kendoGridCellTemplate let-dataItem>
                <span [style.color]="dataItem.status == 'CANCELLED' ? 'red' : dataItem.status == 'TRANSFERRED' ? 'green' : dataItem.status == 'NEW' ? 'blue' : 'black'" >
                  {{ dataItem.work_Package }}
                </span>
              </ng-template>
          </kendo-grid-column>
          <kendo-grid-column field="status" title="Status" width="140">
              <ng-template kendoGridCellTemplate let-dataItem>
                  <span [style.color]="dataItem.status == 'CANCELLED' ? 'red' : dataItem.status == 'TRANSFERRED' ? 'green' : dataItem.status == 'NEW' ? 'blue' : 'black'" >
                    {{ dataItem.status }}
                  </span>
                </ng-template>
            </kendo-grid-column>
            <kendo-grid-column field="planned_Start_Date" title="Planned Started Date" width="180">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <span [style.color]="dataItem.status == 'CANCELLED' ? 'red' : dataItem.status == 'TRANSFERRED' ? 'green' : dataItem.status == 'NEW' ? 'blue' : 'black'" >
                    {{ checkDate(dataItem.planned_Start_Date)  }}
                    </span>
                  </ng-template>
              </kendo-grid-column>
              <kendo-grid-column field="planned_End_Date" title="Planned End Date" width="170">
                  <ng-template kendoGridCellTemplate let-dataItem>
                      <span [style.color]="dataItem.status == 'CANCELLED' ? 'red' : dataItem.status == 'TRANSFERRED' ? 'green' : dataItem.status == 'NEW' ? 'blue' : 'black'" >
                        <!-- {{ dataItem.planned_End_Date }} -->
                        {{ checkDate(dataItem.planned_End_Date)  }}
                      </span>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column field="completion_Date" title="Completion Date" width="170">
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <span [style.color]="dataItem.status == 'CANCELLED' ? 'red' : dataItem.status == 'TRANSFERRED' ? 'green' : dataItem.status == 'NEW' ? 'blue' : 'black'" >
                          <!-- {{ dataItem.completion_Date }} -->
                          {{ checkDate(dataItem.completion_Date)  }}
                        </span>
                      </ng-template>
                  </kendo-grid-column>
                  <kendo-grid-column field="changed_By" title="Modified By" width="140">
                      <ng-template kendoGridCellTemplate let-dataItem>
                          <span [style.color]="dataItem.status == 'CANCELLED' ? 'red' : dataItem.status == 'TRANSFERRED' ? 'green' : dataItem.status == 'NEW' ? 'blue' : 'black'" >
                            {{ dataItem.changed_By }}
                          </span>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="changed_On" title="Date Modified" width="140">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <span [style.color]="dataItem.status == 'CANCELLED' ? 'red' : dataItem.status == 'TRANSFERRED' ? 'green' : dataItem.status == 'NEW' ? 'blue' : 'black'" >
                              {{ dataItem.changed_On }}
                            </span>
                          </ng-template>
                      </kendo-grid-column>

                

        <kendo-grid-excel fileName="{{fileName}}">
        </kendo-grid-excel>
        
  
      </kendo-grid>
  
    </div>
    
  </div>
  <div class="charBlur"></div>
  
    <!-- <kendo-window title="{{notesTitle}}" *ngIf="notesDetails" (close)="closeNotesDetails()" [top]="15" [minWidth]="250"
    [width]="800" [height]="680">
  <div class="row">
    <div class="col-md-12" *ngIf="notesTitle != 'Attribute Image' && selectedNotes.image.trim() == ''">
      <textarea style="height: 500px;" class="form-control" [readonly]="true">{{selectedNotes.text}}</textarea>
    </div>

    <div class="col-md-12" *ngIf="notesTitle == 'Attribute Image' && selectedNotes.image.trim() != ''">
      <img [src]="notesImagePath" alt="{{selectedNotes.text}}" width="auto" height="500" style="position: relative;">
      <p class="mt-2 m-0 p-0">{{selectedNotes.image}}</p>
      <p class="p-0 mt-1">{{selectedNotes.text}}</p>
    </div>

    <div class="col-md-12 text-right mt-2 noteBtn">
      <button class="btn btn-sm" (click)="closeNotesDetails()">Close</button>
    </div>
    </div>
  </kendo-window> -->

<app-asset-work-detail [assetWorkDetailWindow]="assetWorkDetailWindow" [selectedAttribute]="selectedAttribute"
    [selectedAsset]="selectedAsset" *ngIf="assetWorkDetailWindow"
    (closeassetWorkDetailWindow)="closeassetWorkDetailWindow($event)"></app-asset-work-detail>