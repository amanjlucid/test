<kendo-window title="{{title}}" *ngIf="openWOAddPaymentScheduleWindow" (close)="closeAddPaymentScheduleWin()" [top]="10"
  [minWidth]="500" [width]="700" [height]="auto" [minHeight]="400">

  <form [formGroup]="addScheduleForm" id="addScheduleForm" (ngSubmit)="onSubmit()" autocomplete="off">
    <div class="row mt-2">
      <div class="col-md-3">
        <label>Programme:</label>
      </div>
      <div class="col-md-9">
        <input type="text" class="form-control" [readonly]="true" value="{{workProgrammesData?.wprname}}">
      </div>
    </div>
    <div class="row mt-2">
      <div class="col-md-3">
        <label>Works Order:</label>
      </div>
      <div class="col-md-9">
        <input type="text" class="form-control" [readonly]="true" value="{{worksOrderData?.woname}}">
      </div>
    </div>
    <div class="row mt-2">
      <div class="col-md-3">
        <label>Period Start Date:</label>
      </div>
      <div class="col-md-9">
        <input type="text" class="form-control" [minDate]="minDate" ngbDatepicker #j="ngbDatepicker"
          (click)="openCalendar(j)" formControlName="pStartDate"
          [ngClass]="{ 'is-invalid': submitted && formErrors.pStartDate }" autocomplete="off">
        <div *ngIf="submitted && formErrors.pStartDate" class="invalid-feedback">
          <div *ngIf="formErrors.pStartDate">{{ formErrors.pStartDate }}</div>
        </div>
      </div>
    </div>
    <div class="row mt-2">
      <div class="col-md-3">
        <label>Period End Date:</label>
      </div>
      <div class="col-md-9">
        <input type="text" [minDate]="minDate" class="form-control" ngbDatepicker #i="ngbDatepicker"
          (click)="openCalendar(i)" formControlName="pEndDate"
          [ngClass]="{'is-invalid': submitted && formErrors.pEndDate}" autocomplete="off">
        <div *ngIf="submitted && formErrors.pEndDate" class="invalid-feedback">
          <div *ngIf="formErrors.pEndDate">{{ formErrors.pEndDate }}</div>
        </div>
      </div>
    </div>
    <div class="row mt-2">
      <div class="col-md-3">
        <label>Payment Date:</label>
      </div>
      <div class="col-md-9">
        <input type="text" [minDate]="minDate" class="form-control" ngbDatepicker #k="ngbDatepicker"
          (click)="openCalendar(k)" formControlName="paymentDate"
          [ngClass]="{'is-invalid':submitted && formErrors.paymentDate}">
        <div *ngIf="submitted && formErrors.paymentDate" class="invalid-feedback">
          <div *ngIf="formErrors.paymentDate">{{ formErrors.paymentDate }}</div>
        </div>
      </div>
    </div>

    <div class="row mt-2" *ngIf="worksOrderData.wocontracttype == 'STAGE'">
      <div class="col-6">
        <div class="row">
          <div class="col-md-6">
            <label class="py-2">Stage Payment:</label>
          </div>
          <div class="col-md-6">
            <input appCurrencyMask maxDigits="9" type="text" class="form-control" formControlName="stagePayment"
              [ngClass]="{ 'is-invalid': submitted && formErrors.stagePayment }">
            <div *ngIf="submitted && formErrors.stagePayment" class="invalid-feedback">
              <div *ngIf="formErrors.stagePayment">{{ formErrors.stagePayment }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row mt-2" *ngIf="worksOrderData.wocontracttype != 'STAGE'">
      <div class="col-6">
        <div class="row">
          <div class="col-md-6">
            <label>Retention Type:</label>
          </div>
          <div class="col-md-6">
            <fieldset [disabled]="disableRetention" >
              <div class="form-check-inline">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" value="P" formControlName="retentionType">Percentage
                </label>
              </div>
              <div class="form-check-inline mt-2">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" value="V" formControlName="retentionType">Value
                </label>
              </div>
            </fieldset>
          </div>
        </div>
      </div>
      <div class="col-6">
        <div class="row">
          <div class="col-md-6">
            <label>Retention %:</label>
          </div>
          <div class="col-md-6">
            <input numberDecimal maxDigits="3" type="text" class="form-control" autocomplete="off" formControlName="retentionPct"
            [readonly]="isReadOnlyControl('retperc')"
              [ngClass]="{'is-invalid':submitted && formErrors.retentionPct}" placeholder="0.00%">
            <div *ngIf="submitted && formErrors.retentionPct" class="invalid-feedback">
              <div *ngIf="formErrors.retentionPct">{{ formErrors.retentionPct }}</div>
            </div>
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-md-6">
            <label>Retention Value:</label>
          </div>
          <div class="col-md-6">
            <input appCurrencyMask maxDigits="9" autocomplete="off" type="text" class="form-control"
            [readonly]="isReadOnlyControl('retval')"
              formControlName="retentionValue" [ngClass]="{'is-invalid':submitted && formErrors.retentionValue}" placeholder="Â£0.00">
            <div *ngIf="submitted && formErrors.retentionValue" class="invalid-feedback">
              <div *ngIf="formErrors.retentionValue">{{ formErrors.retentionValue }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="text-right mt-3 pt-2 border-top">
      <button type="submit" class="btn btn-sm themeButton mr-1">Submit</button>
      <button type="button" class="btn btn-sm themeButton" (click)="closeAddPaymentScheduleWin()">Cancel</button>
    </div>
  </form>

</kendo-window>

<div class="wopmaddpaymentoverlay"></div>
