<div class="container-fluid flex-grow-1 container-p-y">
    <div class="row">
        <div class="col-md-2 col-sm-3">
            <h4 class="font-weight-bold">
                Reports
            </h4>
        </div>

        <div class="col-md-10 col-sm-9 text-right">
            <button type="button" class="btn btn-sm themeButton mr-1">Preview</button>
            <button type="button" class="btn btn-sm themeButton mr-1">Run</button>

            <button id="showFilePanel" (click)="openSearchBar()" class="btn btn-sm themeButton"><i
                    class="fa fa-search"></i>
            </button>
        </div>
    </div>


    <div class="row">
        <div class="col-md-12">
            <div class="form-inline">
                <label>Categories</label>
                <ng-multiselect-dropdown [placeholder]="'Select Categories'" [data]="categories"
                    [settings]="mulitSelectDropdownSettings" [disabled]="false"
                    (onSelect)="onCategoriesSingleSelectionChange($event)"
                    (onDeSelect)="onCategoriesSingleSelectionChange($event)"
                    (onSelectAll)="onCategoriesSelectionAllChange($event)"
                    (onDeSelectAll)="onCategoriesSelectionAllChange($event)" [(ngModel)]="selectedCategories"
                    #categoriesMultiSelect>
                </ng-multiselect-dropdown>

                <label class="categoryLbl">Category</label>

                <ng-multiselect-dropdown [placeholder]="'Select Category'" [data]="userCategory"
                    [settings]="categoryDropdownSettings" [disabled]="false"
                    (onSelect)="onCategorySingleSelectionChange($event)"
                    (onDeSelect)="onCategorySingleSelectionChange($event)"
                    (onSelectAll)="onCategorySelectionAllChange($event)"
                    (onDeSelectAll)="onCategorySelectionAllChange($event)" [(ngModel)]="selectedCategory">
                </ng-multiselect-dropdown>
            </div>

        </div>
    </div>


    <div class="row mt-2">
        <div class="col-md-12">
            <kendo-grid [kendoGridGroupBinding]="reportList" [groupable]="true" (groupChange)="groupChange($event)"
                [group]="state.group" [height]="720" [loading]="loading" filterable="menu" [resizable]="true"
                [sortable]="{
    allowUnsort: allowUnsort,
    mode: multiple ? 'multiple' : 'single'
    }" [skip]="state.skip" [pageSize]="80" scrollable="virtual" [rowHeight]="rowheight" [sort]="state.sort"
                [selectable]="selectableSettings" [filter]="state.filter" (cellClick)="cellClickHandler($event)"
                [navigable]="true">

                <kendo-grid-column field="favourite" title="" width="25" [filterable]="false" [groupable]="false">
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <i (click)="setFavourite(dataItem)" [ngClass]="{'favourite': dataItem.favourite === 1}"
                            class="fa fa-star" aria-hidden="true"></i>
                    </ng-template>

                </kendo-grid-column>

                <kendo-grid-column title=" " width="25" [filterable]="false">
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <li class="nav-item dropdown list-unstyled" style="margin-top: -7px;">
                            <i data-toggle="dropdown" aria-expanded="false" class="fas fa-bars"
                                (click)="setSeletedRow(dataItem)"></i>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" href="javascript:void(0)"
                                    (click)="openSetUserCategoryWindow(dataItem)">
                                    User Categories</a>
                                <a class="dropdown-item" href="javascript:void(0)"
                                    (click)="openTaskData(dataItem,'single')">Scheduling</a>
                                <a class="dropdown-item" href="javascript:void(0)"
                                    (click)="openParameterWindow(dataItem)">Parameters</a>
                                <a class="dropdown-item" href="javascript:void(0)"
                                    (click)="openTaskData(dataItem,'single')">Preview</a>
                                <a class="dropdown-item" href="javascript:void(0)"
                                    (click)="openTaskData(dataItem,'single')">Run</a>
                            </div>
                        </li>

                    </ng-template>
                </kendo-grid-column>

                <kendo-grid-column field="category" title="Category" width="80">
                </kendo-grid-column>
                <kendo-grid-column field="reportId" title="Report ID" width="60">
                </kendo-grid-column>
                <kendo-grid-column field="reportName" title="Report Name" width="260">
                    <ng-template kendoGridCellTemplate let-dataItem>
                        {{dataItem.reportName}}
                        <span *ngIf="showColumns" class="showCol">{{dataItem.xport_Col}}</span>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column field="reportDescription" title="Report Description" width="160">
                </kendo-grid-column>

                <kendo-grid-column field="count" title="Run History" width="90">
                </kendo-grid-column>



            </kendo-grid>

        </div>
    </div>



</div>




<!-- Search bar -->
<div class="search-container dismiss">

    <h5 style="color:white" class="p-4 m-0 line-height-1 font-weight-bolder bg-light theme-settings-header"> Filters
        <a href="javascript:void(0)" (click)="closeSearchBar()"
            class="theme-settings-close-btn font-weight-light px-4 py-2" style="color:#ffffff;" tabindex="-1">Ã—</a>
    </h5>

    <div class="searchDiv">
        <div class="searchArea">
            <div class="filtersection">
                <span class="filterHead">Search</span>
            </div>

            <div class="form-group mt-1 inlineInp">
                <label class="form-label form-label-sm">Number</label>
                <input (keyup)="triggerFilter($event, 'num')" [(ngModel)]="reportListFilters.number" type="text"
                    class="form-control form-control-sm">
            </div>

            <div class="form-group inlineInp">
                <label class="form-label form-label-sm">Name</label>
                <input (keyup)="triggerFilter($event, 'name')" [(ngModel)]="reportListFilters.name" type="text"
                    class="form-control form-control-sm">
            </div>

            <div class="row mt-2">
                <div class="col-md-6">
                    <!-- <label class="form-check form-check-inline">
                        <input (change)="triggerFilter($event)" [(ngModel)]="reportListFilters.nameMatch"
                            class="form-check-input" type="radio" name="nameMatch" [value]="true">
                        <span class="form-check-label">
                            Match All
                        </span>
                    </label> -->

                    <label class="switcher switcher-secondary">
                        <input (change)="triggerFilter($event, 'nameall')" [checked]="reportListFilters.nameMatchAll"
                            value="{{reportListFilters.nameMatchAll}}" type="checkbox" class="switcher-input">
                        <span class="switcher-indicator colSwitch">
                            <span class="switcher-yes">
                                <span class="ion ion-md-checkmark"></span>
                            </span>
                            <span class="switcher-no">
                                <span class="ion ion-md-close"></span>
                            </span>
                        </span>
                        <span class="switcher-label">Match All</span>
                    </label>
                </div>

                <div class="col-md-6">
                    <!-- <label class="form-check form-check-inline">
                        <input (change)="triggerFilter($event)" [(ngModel)]="reportListFilters.nameMatch"
                            class="form-check-input" type="radio" name="nameMatch" [value]="false">
                        <span class="form-check-label">
                            Match Any
                        </span>
                    </label> -->
                    <label class="switcher switcher-secondary">
                        <input (change)="triggerFilter($event, 'nameany')" [checked]="reportListFilters.nameMatchAny"
                            value="{{reportListFilters.nameMatchAny}}" type="checkbox" class="switcher-input">
                        <span class="switcher-indicator colSwitch">
                            <span class="switcher-yes">
                                <span class="ion ion-md-checkmark"></span>
                            </span>
                            <span class="switcher-no">
                                <span class="ion ion-md-close"></span>
                            </span>
                        </span>
                        <span class="switcher-label">Match Any</span>
                    </label>
                </div>

            </div>

            <div class="form-group inlineInp mt-3">
                <label class="form-label form-label-sm">Column</label>
                <kendo-multiselect [data]="outputColumns" [value]="reportListFilters?.selectedOutputColumns"
                    [allowCustom]="true" (valueChange)="onOutPutColumnChange($event)" [valueNormalizer]="normalizer"
                    [virtual]="outputColumnvirtual">
                </kendo-multiselect>
                <!-- <input type="text" class="form-control form-control-sm"> -->
            </div>

            <div class="row mt-2">
                <div class="col-md-6">
                    <label class="switcher switcher-secondary">
                        <input type="checkbox" (change)="triggerFilter($event, 'columnall')"
                            [checked]="reportListFilters.columnMatchAll" value="{{reportListFilters.columnMatchAll}}"
                            class="switcher-input">
                        <span class="switcher-indicator colSwitch">
                            <span class="switcher-yes">
                                <span class="ion ion-md-checkmark"></span>
                            </span>
                            <span class="switcher-no">
                                <span class="ion ion-md-close"></span>
                            </span>
                        </span>
                        <span class="switcher-label">Match All</span>
                    </label>
                </div>

                <div class="col-md-6">
                    <label class="switcher switcher-secondary">
                        <input type="checkbox" (change)="triggerFilter($event, 'columnany')"
                            [checked]="reportListFilters.columnMatchAny" value="{{reportListFilters.columnMatchAny}}"
                            class="switcher-input">
                        <span class="switcher-indicator colSwitch">
                            <span class="switcher-yes">
                                <span class="ion ion-md-checkmark"></span>
                            </span>
                            <span class="switcher-no">
                                <span class="ion ion-md-close"></span>
                            </span>
                        </span>
                        <span class="switcher-label">Match Any</span>
                    </label>
                </div>

            </div>

            <div class="row mt-1">
                <div class="col-md-6">
                    <label class="switcher switcher-secondary">
                        <input (change)="triggerFilter($event)" [(ngModel)]="reportListFilters.columnExactMatch"
                            type="checkbox" class="switcher-input">
                        <span class="switcher-indicator colSwitch">
                            <span class="switcher-yes">
                                <span class="ion ion-md-checkmark"></span>
                            </span>
                            <span class="switcher-no">
                                <span class="ion ion-md-close"></span>
                            </span>
                        </span>
                        <span class="switcher-label">Exact Match</span>
                    </label>
                </div>

                <div class="col-md-6">
                    <label class="switcher switcher-secondary">
                        <input (change)="showColFn()" type="checkbox" value="{{showColumns}}" class="switcher-input">
                        <span class="switcher-indicator colSwitch">
                            <span class="switcher-yes">
                                <span class="ion ion-md-checkmark"></span>
                            </span>
                            <span class="switcher-no">
                                <span class="ion ion-md-close"></span>
                            </span>
                        </span>
                        <span class="switcher-label">Show Columns</span>
                    </label>
                </div>

            </div>

        </div>


        <div class="viewArea">
            <div class="">
                <span class="filterHead">View</span>
            </div>

            <div class="row mt-1">
                <div class="col-md-12">
                    <label class="switcher switcher-secondary">
                        <input type="checkbox" (change)="reqGridSearch($event)"
                            [(ngModel)]="reportQueryModel.FavouritesOnly" class="switcher-input">
                        <span class="switcher-indicator colSwitch">
                            <span class="switcher-yes">
                                <span class="ion ion-md-checkmark"></span>
                            </span>
                            <span class="switcher-no">
                                <span class="ion ion-md-close"></span>
                            </span>
                        </span>
                        <span class="switcher-label">Show Favourites</span>
                    </label>
                </div>

                <div class="col-md-12 mt-1">
                    <label class="switcher switcher-secondary">
                        <input (change)="reqGridSearch($event)" [(ngModel)]="reportQueryModel.IsShceduled"
                            type="checkbox" class="switcher-input">
                        <span class="switcher-indicator colSwitch">
                            <span class="switcher-yes">
                                <span class="ion ion-md-checkmark"></span>
                            </span>
                            <span class="switcher-no">
                                <span class="ion ion-md-close"></span>
                            </span>
                        </span>
                        <span class="switcher-label">Show Scheduled</span>
                    </label>
                </div>

            </div>
        </div>

        <div class="recentFilterArea">
            <div class="">
                <span class="filterHead">Recent</span>
            </div>

            <div class="row mt-1">

                <div class="col-md-6">
                    <label class="switcher switcher-secondary">
                        <input (change)="reqGridSearch2($event, 0)" [(ngModel)]="reportListFilters.all" type="checkbox"
                            class="switcher-input">
                        <span class="switcher-indicator colSwitch">
                            <span class="switcher-yes">
                                <span class="ion ion-md-checkmark"></span>
                            </span>
                            <span class="switcher-no">
                                <span class="ion ion-md-close"></span>
                            </span>
                        </span>
                        <span class="switcher-label">All</span>
                    </label>
                </div>

                <div class="col-md-6">
                    <label class="switcher switcher-secondary">
                        <input (change)="reqGridSearch2($event, 1)" [(ngModel)]="reportListFilters.lastMonth"
                            type="checkbox" class="switcher-input">
                        <span class="switcher-indicator colSwitch">
                            <span class="switcher-yes">
                                <span class="ion ion-md-checkmark"></span>
                            </span>
                            <span class="switcher-no">
                                <span class="ion ion-md-close"></span>
                            </span>
                        </span>
                        <span class="switcher-label">Last Month</span>
                    </label>
                </div>

            </div>

            <div class="row mt-1">
                <div class="col-md-6">
                    <label class="switcher switcher-secondary">
                        <input (change)="reqGridSearch2($event, 2)" [(ngModel)]="reportListFilters.last3Month"
                            type="checkbox" class="switcher-input">
                        <span class="switcher-indicator colSwitch">
                            <span class="switcher-yes">
                                <span class="ion ion-md-checkmark"></span>
                            </span>
                            <span class="switcher-no">
                                <span class="ion ion-md-close"></span>
                            </span>
                        </span>
                        <span class="switcher-label">Last 3 Months</span>
                    </label>
                </div>

                <div class="col-md-6">
                    <label class="switcher switcher-secondary">
                        <input (change)="reqGridSearch2($event, 3)" [(ngModel)]="reportListFilters.last12Month"
                            type="checkbox" class="switcher-input">
                        <span class="switcher-indicator colSwitch">
                            <span class="switcher-yes">
                                <span class="ion ion-md-checkmark"></span>
                            </span>
                            <span class="switcher-no">
                                <span class="ion ion-md-close"></span>
                            </span>
                        </span>
                        <span class="switcher-label">Last 12 Month</span>
                    </label>
                </div>

            </div>
        </div>


        <div class="footerArea">
            <button id="clearBtn" (click)="clearFilter()" class="btn btn-sm themeButton">Clear
            </button>
        </div>


    </div>
</div>

<div class="reportParamOverlay"></div>
<app-report-parameter *ngIf="openReportParameter" [openReportParameter]="openReportParameter" [selectedReport]="selectedReport" (closeRportparamWindow)="closeRportparamWindow($event)"></app-report-parameter>

<app-set-user-category *ngIf="openSetUserCategory" [openSetUserCategory]="openSetUserCategory" [selectedReport]="selectedReport" (closeSetUserCategoryWindow)="closeSetUserCategoryWindow($event)"></app-set-user-category>