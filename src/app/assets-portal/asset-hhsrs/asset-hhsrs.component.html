<div class="row" *ngIf="hhsrsData?.length > 0"> 
   
      <div class="col-md-2">
          <div class="dropdown" id="nesting-dropdown-demo">
              <button type="button" class="btn btn-sm dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Export</button>
              <div class="dropdown-menu" x-placement="bottom-start" style="position: absolute; will-change: top, left; top: 38px; left: 0px;">
    
                  <a class="dropdown-item" (click)="exportToExcel(grid,'xlsx')" href="javascript:void(0)">Export Grid</a>
                  <a class="dropdown-item" (click)="exportToExcel(grid,'xlsx','selected')" href="javascript:void(0)">Export
                      Selected</a>  
                <!-- <div class="dropdown-toggle">
                  <div class="dropdown-item">Export Grid</div>
                  <div class="dropdown-menu">
                      <a class="dropdown-item" (click)="exportToExcel(grid,'xlsx')" href="javascript:void(0)">Export Excel</a>
                      <a class="dropdown-item" (click)="exportToExcel(grid,'csv')" href="javascript:void(0)">Export Csv</a>
                      <a class="dropdown-item" (click)="exportToExcel(grid,'txt')" href="javascript:void(0)">Export Text</a>
                      <a class="dropdown-item" (click)="exportToExcel(grid,'html')" href="javascript:void(0)">Export Html</a>
                  </div>
                </div>
               
               
                <div class="dropdown-toggle">
                  <div class="dropdown-item">Export Selected</div>
                  <div class="dropdown-menu">
                      <a class="dropdown-item" (click)="exportToExcel(grid,'xlsx','selected')" href="javascript:void(0)">Export Excel</a>
                      <a class="dropdown-item" (click)="exportToExcel(grid,'csv','selected')" href="javascript:void(0)">Export Csv</a>
                      <a class="dropdown-item" (click)="exportToExcel(grid,'txt','selected')" href="javascript:void(0)">Export Text</a>
                      <a class="dropdown-item" (click)="exportToExcel(grid,'html','selected')" href="javascript:void(0)">Export Html</a>
                  </div>
                </div> -->
              </div>
            </div>
        </div>

  </div>

<div class="row mt-2">
    <div class="col-md-12">
      <kendo-grid 
      #grid="kendoGrid"
      [data]="gridView"
      [selectable]="{
            mode: 'multiple'
          }" 
      [kendoGridSelectBy]="mySelectionKey"
      [selectedKeys]="mySelection"
      [groupable]="true" 
      (groupChange)="groupChange($event)"
      [group]="state.group"
      [skip]="state.skip" 
      [sort]="state.sort" 
      [filter]="state.filter"
      filterable="menu" 
      [resizable]="true"
      [sortable]="{
            allowUnsort: allowUnsort,
            mode: multiple ? 'multiple' : 'single'
            }" 
      (sortChange)="sortChange($event)" 
      (filterChange)="filterChange($event)" 
      [height]="610"
      >
        <kendo-grid-column field="hascode" width="50" [filterable]="false" [groupable]="false">
            <ng-template kendoGridHeaderTemplate>
                <!-- <i class="fas fa-sticky-note"></i> -->
                <img style="height:14px; width:16px;" src="assets/img/icons/attach.png" />
            </ng-template>

            <ng-template kendoGridCellTemplate let-dataItem>
                <li class="nav-item dropdown list-unstyled" *ngIf="dataItem.notepadLists?.length > 0">
                    <!-- <i data-toggle="dropdown" aria-expanded="true" class="fas fa-sticky-note d-block"></i> -->
                    <img data-toggle="dropdown" aria-expanded="true" style="height:14px; width:16px;" class="attachmentIcon" src="assets/img/icons/attach.png" />
                    <div class="dropdown-menu">
                      <a class="dropdown-item" href="javascript:void(0)"
                        *ngFor="let notes of dataItem.notepadLists" (click)="openNotesDetails(notes)">{{ notes.name}}</a>
                    </div>
                  </li>
                <!-- <i *ngIf="dataItem.Discontinued" class="fas fa-sticky-note d-block"></i> -->
                
            </ng-template>


        </kendo-grid-column>
        <kendo-grid-column field="hazard_Group" title="Hazard Group" width="140">
            <ng-template kendoGridCellTemplate let-dataItem>
                <span [style.color]="dataItem.status == 'Risk Identified' ? 'red' : 'black'" >
                  {{ dataItem.hazard_Group }}
                </span>
              </ng-template>
         
        </kendo-grid-column>
        <kendo-grid-column field="hazard_Name" title="Hazard Name" width="160">
            <ng-template kendoGridCellTemplate let-dataItem>
                <span [style.color]="dataItem.status == 'Risk Identified' ? 'red' : 'black'" >
                  {{ dataItem.hazard_Name }}
                </span>
              </ng-template>
        </kendo-grid-column>
        <kendo-grid-column field="status" title="Status" width="110">
            <ng-template kendoGridCellTemplate let-dataItem>
                <span [style.color]="dataItem.status == 'Risk Identified' ? 'red' : 'black'" >
                  {{ dataItem.status }}
                </span>
              </ng-template>
        </kendo-grid-column>
        <kendo-grid-column field="band" title="Band" width="110">
            <ng-template kendoGridCellTemplate let-dataItem>
                <span [style.color]="dataItem.status == 'Risk Identified' ? 'red' : 'black'" >
                  {{ dataItem.band }}
                </span>
              </ng-template>
        </kendo-grid-column>
        <kendo-grid-column field="score" title="Score" width="140" filter="numeric">
            <ng-template kendoGridCellTemplate let-dataItem>
                <span [style.color]="dataItem.status == 'Risk Identified' ? 'red' : 'black'" >
                  {{ dataItem.score }}
                </span>
              </ng-template>
        </kendo-grid-column>
        
        <kendo-grid-column field="category" title="Category" width="110">
            <ng-template kendoGridCellTemplate let-dataItem>
                <span [style.color]="dataItem.status == 'Risk Identified' ? 'red' : 'black'" >
                  {{ dataItem.category }}
                </span>
              </ng-template>
          </kendo-grid-column>
          <kendo-grid-column field="assessment_Date" title="Assessment Date" width="140">
              <ng-template kendoGridCellTemplate let-dataItem>
                  <span [style.color]="dataItem.status == 'Risk Identified' ? 'red' : 'black'" >
                    {{ dataItem.assessment_Date }}
                  </span>
                </ng-template>
            </kendo-grid-column>
            <kendo-grid-column field="assessment_User" title="Assessment User" width="140">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <span [style.color]="dataItem.status == 'Risk Identified' ? 'red' : 'black'" >
                      {{ dataItem.assessment_User }}
                    </span>
                  </ng-template>
              </kendo-grid-column>
                

        <kendo-grid-excel fileName="{{fileName}}">
        </kendo-grid-excel>
        
  
      </kendo-grid>
  
    </div>
    
  </div>
  <div class="portalwBlur"></div>
  
  <kendo-window title="{{notesTitle}}" *ngIf="notesDetails" (close)="closeNotesDetails()" [top]="15" [minWidth]="250"
  [width]="800" [height]="680">
<div class="row">
  <div class="col-md-12" *ngIf="notesTitle != 'HHSRS Image' && selectedNotes.linkType == 'N'">
    <textarea style="height: 500px;" class="form-control" [readonly]="true">{{selectedNotes.text}}</textarea>
  </div>

  <div class="col-md-12" *ngIf="notesTitle == 'HHSRS Image' && selectedNotes.linkType == 'P'">
    <img [src]="notesImagePath" alt="{{selectedNotes.text}}" width="auto" style="position: relative; height: 500px;">
    <p class="mt-2 m-0 p-0">{{selectedNotes.link}}</p>
    <p class="p-0 mt-1">{{selectedNotes.text}}</p>
  </div>

  <div class="col-md-12 text-right mt-2 noteBtn">
    <button class="btn btn-sm" (click)="closeNotesDetails()">Close</button>
  </div>
  </div>
</kendo-window>